#!/usr/bin/python
###############################################################################
# This file is part of openWNS (open Wireless Network Simulator)
# _____________________________________________________________________________
#
# Copyright (C) 2004-2007
# Chair of Communication Networks (ComNets)
# Kopernikusstr. 16, D-52074 Aachen, Germany
# phone: ++49-241-80-27910,
# fax: ++49-241-80-22242
# email: info@openwns.org
# www: http://www.openwns.org
# _____________________________________________________________________________
#
# openWNS is free software; you can redistribute it and/or modify it under the
# terms of the GNU Lesser General Public License version 2 as published by the
# Free Software Foundation;
#
# openWNS is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
# A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more
# details.
#
# You should have received a copy of the GNU Lesser General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
###############################################################################

import sys
import traceback

from PyQt4 import QtGui

try:
    import wrowser.Windows
except ImportError:

    import os.path
    # Path to this script
    p = sys.path[0]
    searchPath = os.path.dirname(sys.path[0])

    print "No global installation of wrowser found."
    print "Prepending %s to sys.path" % searchPath 

    sys.path.insert(0, searchPath)

    import wrowser.Windows


def wrowserExceptHook(eType, eValue, eTraceback):
    message = "".join(traceback.format_exception(eType, eValue, eTraceback))
    print message
    response = QtGui.QMessageBox.critical(QtGui.QApplication.activeWindow(), "Python Exception", message, "Exit", "Debug", "Continue")
    if response == 0:
        sys.exit(255)
    elif response == 1:
        import pdb
        pdb.set_trace()
    else:
        pass

if __name__ == "__main__":
    application = QtGui.QApplication(sys.argv)
    application.setQuitOnLastWindowClosed(True)
    application.setApplicationName("Wrowser")
    application.setWindowIcon(QtGui.QIcon("icon.png"))
    application.setOrganizationName("RWTH Aachen University - ComNets")
    application.setOrganizationDomain("www.comnets.rwth-aachen.de")
    widget = wrowser.Windows.Main()
    widget.show()
    sys.excepthook = wrowserExceptHook
    sys.exit(application.exec_())
